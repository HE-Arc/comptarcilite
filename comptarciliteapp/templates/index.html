{% extends 'base.html' %}
{% block title %}Comptarcilite index{% endblock %}
{% block import %}
{% load static %}
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script type="text/javascript" src="{% static "js/vueApp.js" %}"></script>
{% endblock %}
{% block content %}
<div class="container" id="app">

    <div class="row title-spacer">
        <div class="col-md-12">
            <h1 class="display-4 mb-5">Comptarcilité index</h1>
        </div>
    </div>
    <div class="row space-for-bar-under border-bottom">
        <div class="col-md-3">
            <h2>Liste des comptes</h2>
        </div>
        <div class="col-md-9">
            <h2 class="text-center">Détails du compte</h2>
        </div>
    </div>

    <div class="row">
        <div class="col-md-2">
            <ul class="list-unstyled">
                <li v-for="(account, index) in accounts">
                    <button type="button" class="btn btn-light border w-100 vertical-spacer" @click="getAccount(account.id)">
                        [[account.name]]
                    </button>
                </li>
            </ul>
        </div>

        <div class="col-md-9 offset-md-1">
            <h3 v-if="accountGet" class="account-name-spacer">[[accounts[accountId].name]]</h3>
            <h3 v-else>Sélectionnez un compte !</h3>

            <div v-if="accountGet" class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th scope="col">Date</th>
                            <th scope="col">Description</th>
                            <th scope="col">Crédit</th>
                            <th scope="col">Débit</th>
                        </tr>
                    </thead>
                    <tr v-if="transactions !== []" v-for="(transaction, index) in transactions">
                        <td>[[transaction.timestamp.split("T")[0] ]] [[ transaction.timestamp.split("T")[1].split("+")[0] ]]</td>
                        <td>[[transaction.description]]</td>
                        <td v-if="transaction.amount>0">[[ transaction.amount.replace(/\B(?=(\d{3})+(?!\d))/g, "'") ]]</td>
                        <td v-else></td>
                        <td v-if="transaction.amount>0"></td>
                        <td v-else>[[transaction.amount.split("-")[1].replace(/\B(?=(\d{3})+(?!\d))/g, "'") ]]</td>
                    </tr>
                </table>

                <p>
                    Balance du compte :
                    <span v-if="total[0] == '-'" class="text-danger total">[[ total ]]</span>
                    <span v-else class="text-success total">[[ total ]]</span>
                </p>
            </div>
        </div>

    </div>
</div>

{% endblock %}